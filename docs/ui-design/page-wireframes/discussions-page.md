# 讨论页面线框图

## 📋 页面信息

- **页面名称**: 讨论页面
- **页面路径**: `/discussions`
- **页面类型**: 社区互动页面
- **访问权限**: 需要登录
- **创建日期**: 2025年10月27日
- **最后更新**: 2025年10月27日
- **数据来源**: GitHub Discussions API

## 🎯 页面布局

### 讨论列表视图
```
┌─────────────────────────────────────────────────────────┐
│ DIPCP Logo    导航菜单                                    │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  💬 讨论                                       [+新讨论] │
│                                                          │
│  ┌─────────────────────────────────────────────────────┐ │
│  │ 📌 General - 一般讨论                               │ │
│  │                                                     │ │
│  │ ┌─────────────────────────────────────────────────┐ │ │
│  │ │ 📌 欢迎新成员！                                  │ │ │
│  │ │   👤 Alice · 3天前 · 💬 12条回复                 │ │ │
│  │ │   欢迎新成员加入我们的项目...                      │ │ │
│  │ │   🏷️ 欢迎 新人                                  │ │ │
│  │ └─────────────────────────────────────────────────┘ │ │
│  │                                                     │ │
│  │ ┌─────────────────────────────────────────────────┐ │ │
│  │ │ 💡 如何提交高质量的贡献？                         │ │ │
│  │ │   👤 Bob · 1周前 · 💬 5条回复                   │ │ │
│  │ │   分享一些提交高质量贡献的建议...                 │ │ │
│  │ │   🏷️ 帮助 建议                                  │ │ │
│  │ └─────────────────────────────────────────────────┘ │ │
│  │                                                     │ │
│  └─────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌─────────────────────────────────────────────────────┐ │
│  │ 📝 Ideas - 想法和建议                               │ │
│  │                                                     │ │
│  │ ┌─────────────────────────────────────────────────┐ │ │
│  │ │ 🚀 建议添加自动代码检查功能                       │ │ │
│  │ │   👤 Carol · 5天前 · 💬 8条回复                 │ │ │
│  │ │   建议在CI/CD流程中添加自动代码检查...             │ │ │
│  │ │   🏷️ 功能建议 CI/CD                              │ │ │
│  │ └─────────────────────────────────────────────────┘ │ │
│  │                                                     │ │
│  └─────────────────────────────────────────────────────┘ │
│                                                          │
│  ┌─────────────────────────────────────────────────────┐ │
│  │ ❓ Q&A - 问答                                        │ │
│  │                                                     │ │
│  │ ┌─────────────────────────────────────────────────┐ │ │
│  │ │ ❓ 如何在本地运行这个项目？                        │ │ │
│  │ │   👤 David · 2周前 · 💬 3条回复                  │ │ │
│  │ │   想了解一下本地开发环境的配置...                  │ │ │
│  │ │   🏷️ 帮助 环境配置                               │ │ │
│  │ └─────────────────────────────────────────────────┘ │ │
│  │                                                     │ │
│  └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 讨论详情视图
```
┌─────────────────────────────────────────────────────────┐
│ DIPCP Logo    导航菜单                                    │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ← 返回讨论列表                                         │
│                                                         │
│  ┌─────────────────────────────────────────────────────┐ │
│  │ 💡 如何提交高质量的贡献？                             │ │
│  │                                                     │ │
│  │ ┌─────────────────────────────────────────────────┐ │ │
│  │ │ 👤 Bob                                          │ │ │
│  │ │ 📅 1周前                                        │ │ │
│  │ │ 🏷️ 帮助 建议                                    │ │ │
│  │ │                                                 │ │ │
│  │ │ 大家好，我想分享一些关于如何提交高质量贡献的        │ │ │
│  │ │ 建议：                                          │ │ │
│  │ │                                                 │ │ │
│  │ │ 1. **代码质量**                                  │ │ │
│  │ │    - 确保代码遵循项目规范                         │ │ │
│  │ │    - 添加适当的注释                              │ │ │
│  │ │    - 保持代码简洁易读                            │ │ │
│  │ │                                                 │ │ │
│  │ │ 2. **提交信息**                                  │ │ │
│  │ │    - 使用清晰的提交信息                           │ │ │
│  │ │    - 描述修改的原因和影响                         │ │ │
│  │ │                                                 │ │ │
│  │ │ 大家有什么补充的吗？                              │ │ │
│  │ └─────────────────────────────────────────────────┘ │ │
│  │                                                     │ │
│  │ ─────────────────────────────────────────────────── │ │
│  │                                                     │ │
│  │ 💬 回复 (5)                                         │ │
│  │                                                     │ │
│  │ ┌─────────────────────────────────────────────────┐ │ │
│  │ │ 👤 Alice · 6天前                                │ │ │
│  │ │                                                 │ │ │
│  │ │ 非常好的建议！我想补充一点关于测试的：             │ │ │
│  │ │                                                 │ │ │
│  │ │ - 确保添加单元测试                               │ │ │
│  │ │ - 测试覆盖率应该达到一定标准                      │ │ │
│  │ │                                                 │ │ │
│  │ │ 👍 3  👍                                        │ │ │
│  │ └─────────────────────────────────────────────────┘ │ │
│  │                                                     │ │
│  │ ┌─────────────────────────────────────────────────┐ │ │
│  │ │ 👤 Carol · 4天前                                │ │ │
│  │ │                                                 │ │ │
│  │ │ 同意！我觉得还可以加一个点：                       │ │ │
│  │ │                                                 │ │ │
│  │ │ - 确保新功能有相关的文档说明                       │ │ │
│  │ │                                                 │ │ │
│  │ │ 👍 1                                            │ │ │
│  │ └─────────────────────────────────────────────────┘ │ │
│  │                                                     │ │
│  │ ┌─────────────────────────────────────────────────┐ │ │
│  │ │ 💬 添加回复...                                  │ │ │
│  │ └─────────────────────────────────────────────────┘ │ │
│  │                                                     │ │
│  │ [向上滚动到讨论]                                     │ │
│  └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

## 🎯 功能说明

### 分类系统
- **General（一般讨论）**: 日常交流和项目讨论
- **Ideas（想法和建议）**: 新功能建议和改进想法
- **Q&A（问答）**: 技术问题和解决方案
- **Announcements（公告）**: 项目重要公告和更新

### 讨论列表功能
- **分类展示**: 按分类组织讨论主题
- **置顶标记**: 重要讨论标记为📌置顶
- **回复统计**: 显示每个讨论的回复数量
- **时间显示**: 人性化的时间显示（如"3天前"）
- **标签系统**: 显示相关标签，便于分类查找
- **搜索功能**: 支持搜索讨论标题和内容

### 讨论详情功能
- **作者信息**: 显示讨论创建者
- **时间戳**: 显示创建时间和最后更新时间
- **标签展示**: 显示所有相关标签
- **内容渲染**: Markdown格式支持，代码高亮
- **回复系统**: 支持多级回复和点赞
- **参与度指标**: 显示回复数和点赞数

### 交互操作
- **创建讨论**: 点击"新讨论"按钮创建新主题
- **回复讨论**: 在讨论详情页添加回复
- **点赞**: 为有价值的回复点赞
- **关注**: 关注感兴趣的讨论，接收通知
- **编辑**: 编辑自己创建的讨论或回复
- **删除**: 删除自己创建的讨论或回复（需权限）

## 🎨 设计要点

### 视觉层次
1. **分类导航**: 左侧显示讨论分类
2. **讨论列表**: 中间显示讨论列表
3. **详情面板**: 点击后显示讨论详情

### 交互设计
- **分类切换**: 点击分类查看该分类下的所有讨论
- **排序选项**: 按最新、最热、最多回复排序
- **搜索过滤**: 输入关键词搜索讨论
- **标签筛选**: 点击标签筛选相关讨论
- **快速回复**: 在列表页直接快速回复

### 状态管理
- **加载状态**: 显示数据加载中的状态
- **空状态**: 分类下没有讨论时显示提示
- **错误状态**: 加载失败时显示错误信息
- **新消息**: 显示未读回复数量

## 📱 移动端适配

### 移动端布局
```
┌─────────────────────────────────────────┐
│ DIPCP Logo                               │
├─────────────────────────────────────────┤
│                                         │
│  💬 讨论                    [+新讨论]    │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 📌 General                     │   │
│  │ 3个讨论                         │   │
│  │                                 │   │
│  │ 📌 欢迎新成员！                 │   │
│  │ 👤 Alice · 3天前 · 💬 12        │   │
│  │                                 │   │
│  │ 💡 如何提交高质量贡献？         │   │
│  │ 👤 Bob · 1周前 · 💬 5           │   │
│  │                                 │   │
│  │ 💡 项目路线图                   │   │
│  │ 👤 Carol · 2周前 · 💬 8         │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 📝 Ideas                        │   │
│  │ 2个讨论                         │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ ❓ Q&A                          │   │
│  │ 1个讨论                         │   │
│  └─────────────────────────────────┘   │
└─────────────────────────────────────────┘
```

### 移动端特点
- **垂直布局**: 适合手机屏幕的垂直滚动
- **简化分类**: 移动端分类以卡片形式展示
- **滑动操作**: 支持滑动查看更多回复
- **快捷操作**: 重要操作固定在底部

## 🔗 页面跳转

### 跳转目标
- **讨论详情**: 点击讨论标题跳转到详情页
- **创建讨论**: 点击"新讨论"跳转到创建页
- **用户资料**: 点击用户头像跳转到用户资料页
- **返回列表**: 从详情页返回讨论列表

### 跳转条件
- **用户已登录**: 所有操作都需要用户登录状态
- **创建讨论**: 用户需要至少是协作者身份
- **回复讨论**: 所有登录用户都可以回复
- **管理操作**: 仅管理员可以删除或置顶讨论

## 📊 数据来源

### 讨论数据（GitHub API via Octokit）
- **分类信息**: 从 GitHub Discussions API 获取分类列表
- **讨论列表**: 通过 `octokit.rest.discussions.listForRepo()` 获取
- **讨论详情**: 通过 `octokit.rest.discussions.get()` 获取
- **回复数据**: 通过 `octokit.rest.discussions.listComments()` 获取
- **用户信息**: 从讨论和回复中获取用户信息
- **标签信息**: 从讨论和回复中获取标签信息
- **API库**: 使用 `@octokit/rest` 库进行 GitHub API 调用

### 分类结构
```javascript
categories: [
  {
    id: 'general',
    name: 'General',
    emoji: '💬',
    description: '一般讨论'
  },
  {
    id: 'ideas',
    name: 'Ideas',
    emoji: '💡',
    description: '想法和建议'
  },
  {
    id: 'qna',
    name: 'Q&A',
    emoji: '❓',
    description: '问答'
  },
  {
    id: 'announcements',
    name: 'Announcements',
    emoji: '📢',
    description: '公告'
  }
]
```

### 讨论数据结构
```javascript
discussion: {
  number: 1,
  id: 'discussion_001',
  title: '欢迎新成员！',
  body: 'Markdown内容',
  category: 'general',
  author: {
    login: 'alice',
    avatar_url: 'https://...'
  },
  created_at: '2025-10-20T10:00:00Z',
  updated_at: '2025-10-23T14:30:00Z',
  comments_count: 12,
  upvote_count: 5,
  answered: false,
  pinned: true,
  locked: false,
  labels: ['欢迎', '新人'],
  reactions: {
    '+1': 3,
    '-1': 0,
    'heart': 2
  }
}
```

## 🎨 设计规范

### 组件规范
- **讨论卡片**: 使用统一的卡片样式展示讨论
- **回复卡片**: 回复使用缩进显示层级关系
- **按钮**: 统一的按钮样式系统
- **图标**: 使用emoji图标保持简洁
- **标签**: 圆角标签样式

### 动画规范
- **列表加载**: 淡入效果
- **详情切换**: 滑动过渡效果
- **回复展开**: 折叠/展开动画
- **加载状态**: 骨架屏显示

## 🔧 技术实现

### 核心功能
1. **分类管理**: 获取和管理讨论分类
2. **讨论列表**: 获取和渲染讨论列表
3. **讨论详情**: 获取和渲染讨论详情
4. **回复系统**: 提交和渲染回复
5. **搜索过滤**: 按关键词搜索讨论
6. **排序功能**: 按时间、热度排序
7. **标签管理**: 显示和管理标签

### GitHub API集成（使用 Octokit）

#### 初始化 Octokit
```javascript
import { Octokit } from '@octokit/rest';

const octokit = new Octokit({
  auth: token, // GitHub Personal Access Token
});
```

#### 获取讨论列表
```javascript
const { data: discussions } = await octokit.rest.discussions.listForRepo({
  owner: 'org-or-owner',
  repo: 'repository-name',
  per_page: 30,
});
```

#### 获取讨论详情
```javascript
const { data: discussion } = await octokit.rest.discussions.get({
  owner: 'org-or-owner',
  repo: 'repository-name',
  discussion_number: discussionNumber,
});
```

#### 获取讨论回复
```javascript
const { data: comments } = await octokit.rest.discussions.listComments({
  owner: 'org-or-owner',
  repo: 'repository-name',
  discussion_number: discussionNumber,
});
```

#### 创建讨论
```javascript
const { data: newDiscussion } = await octokit.rest.discussions.create({
  owner: 'org-or-owner',
  repo: 'repository-name',
  title: '讨论标题',
  body: '讨论内容（Markdown格式）',
  category: 'general', // general, ideas, qna, announcements
});
```

#### 回复讨论
```javascript
const { data: comment } = await octokit.rest.discussions.createComment({
  owner: 'org-or-owner',
  repo: 'repository-name',
  discussion_number: discussionNumber,
  body: '回复内容（Markdown格式）',
});
```

#### 更新讨论
```javascript
const { data: updatedDiscussion } = await octokit.rest.discussions.update({
  owner: 'org-or-owner',
  repo: 'repository-name',
  discussion_number: discussionNumber,
  title: '更新后的标题',
  body: '更新后的内容',
});
```

#### 删除讨论
```javascript
await octokit.rest.discussions.delete({
  owner: 'org-or-owner',
  repo: 'repository-name',
  discussion_number: discussionNumber,
});
```

#### 点赞回复
```javascript
await octokit.rest.reactions.createForDiscussionComment({
  owner: 'org-or-owner',
  repo: 'repository-name',
  discussion_number: discussionNumber,
  comment_number: commentNumber,
  content: '+1', // 支持: '+1', '-1', 'laugh', 'confused', 'heart', 'hooray', 'rocket', 'eyes'
});
```

### 响应式设计
- **桌面端**: 侧边栏分类 + 主内容区域
- **平板端**: 折叠式分类菜单 + 主内容区域
- **移动端**: 底部分类导航 + 主内容区域

## 🎯 用户体验

### 新手友好
- **清晰的分类**: 分类一目了然
- **搜索提示**: 提供搜索建议和热门关键词
- **操作引导**: 初次使用显示操作引导
- **帮助链接**: 提供GitHub Discussions帮助链接

### 高效操作
- **快速回复**: 支持快速回复常用内容
- **@提醒**: 支持@用户提醒
- **快捷键**: 支持键盘快捷键操作
- **草稿保存**: 自动保存回复草稿

### 社区互动
- **通知系统**: 回复和@时推送通知
- **热门讨论**: 突出显示热门讨论
- **贡献榜**: 显示活跃用户榜单
- **相关讨论**: 推荐相关讨论

## 📝 更新日志

### 2025-10-27
- **创建页面**: 添加讨论页面设计文档
- **GitHub集成**: 设计基于GitHub Discussions API
- **分类系统**: 设计General、Ideas、Q&A、Announcements分类
- **回复系统**: 设计多级回复和点赞功能
- **移动端适配**: 设计移动端响应式布局
- **搜索过滤**: 设计搜索和标签过滤功能

### 设计原则
- **模仿GitHub**: 参考GitHub Discussions的设计
- **社区驱动**: 鼓励用户参与讨论和互动
- **权限管理**: 区分查看、回复、管理的权限
- **实时更新**: 支持实时更新讨论和回复

---

**文档状态**: 已完成  
**最后更新**: 2025年10月27日  
**负责人**: UI设计团队  
**参考**: GitHub Discussions UI/UX Design

